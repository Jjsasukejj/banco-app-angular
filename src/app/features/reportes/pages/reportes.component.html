<h2>Reporte de Movimientos</h2>

<!-- Filtros -->
<div class="toolbar">
  <div class="form-row">
    <label>Cliente ID</label>
    <input type="text" [(ngModel)]="clienteId" />
  </div>

  <div class="form-row">
    <label>Fecha Desde</label>
    <input type="date" [(ngModel)]="fechaInicio" />
  </div>

  <div class="form-row">
    <label>Fecha Hasta</label>
    <input type="date" [(ngModel)]="fechaFin" />
  </div>

  <button class="btn btn-primary" (click)="buscar()" [disabled]="loading">
    Buscar
  </button>

  <button *ngIf="reporte && !loading" class="btn btn-secondary" (click)="descargarPdf()">
    Descargar PDF
  </button>
</div>

<!-- Error -->
<div *ngIf="error" class="error">
  {{ error }}
</div>

<!-- Loading -->
<div *ngIf="loading">
  Cargando reporte...
</div>

<!-- Resumen -->
<div *ngIf="reporte && !loading">
  <h3>Cliente ID: {{ reporte.clienteId }}</h3>

  <div class="summary">
    <div>Total Créditos: {{ reporte.totalCredito | currency }}</div>
    <div>Total Débitos: {{ reporte.totalDebito | currency }}</div>
  </div>

  <p *ngIf="reporte.movimientos.length === 0">
    No existen movimientos en el rango seleccionado.
  </p>

  <table *ngIf="reporte.movimientos.length > 0" border="1" cellpadding="8">
    <thead>
      <tr>
        <th>Fecha</th>
        <th>Cliente</th>
        <th>Numero Cuenta</th>
        <th>Tipo</th>
        <th>Saldo Inicial</th>
        <th>Estado</th>
        <th>Movimiento</th>
        <th>Saldo Disponible</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let m of reporte.movimientos">
        <td>{{ m.fecha | date:'short' }}</td>
        <td>{{ m.cliente }}</td>
        <td>{{ m.numeroCuenta }}</td>
        <td>{{ m.tipoCuenta }}</td>
        <td>{{ m.saldoInicial | currency }}</td>
        <td>{{ m.estado }}</td>
        <td>{{ m.movimiento | currency }}</td>
        <td>{{ m.saldoDisponible | currency }}</td>
      </tr>
    </tbody>
  </table>
</div>